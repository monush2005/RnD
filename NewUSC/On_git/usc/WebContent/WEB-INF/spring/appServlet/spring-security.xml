<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:security="http://www.springframework.org/schema/security"
	xmlns:mvc="http://www.springframework.org/schema/mvc" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
    http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-4.0.xsd
    http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-4.0.xsd">

	<!-- Root Context: defines shared resources visible to all other web components -->
	<security:http authentication-manager-ref="dao-auth"
		auto-config="true" use-expressions="true">
		<security:headers>
			<security:frame-options policy="SAMEORIGIN" />
			<security:xss-protection block="true" />
			<security:cache-control />
		</security:headers>
		<security:csrf />
		<!-- <security:intercept-url pattern="/admin/**" access="hasRole('ROLE_ADMIN')" 
			/> -->
		<!-- <security:intercept-url pattern="/db/**" access="hasRole('ROLE_DB')" 
			/> -->
		<!-- <security:intercept-url pattern="/user/**" access="hasRole('ROLE_USER')" 
			/> -->
		<!-- <security:intercept-url pattern="/logout" access="hasAnyRole('ROLE_USER','ROLE_ADMIN')" 
			/> -->
		<!-- <security:intercept-url pattern="/preLogin" access="permitAll" /> -->
		<!-- <security:intercept-url pattern="/login" access="hasAnyRole('ROLE_GUEST','ROLE_USER','ROLE_ADMIN')" 
			/> -->
		<!-- <security:intercept-url pattern="/**" access="permitAll" /> -->
		<!-- <security:form-login login-page="/login" authentication-failure-url="/preLogin" 
			username-parameter="userId" password-parameter="password" always-use-default-target="true" 
			default-target-url="/home" /> -->
		<!-- <security:logout invalidate-session="true" logout-success-url="/" 
			logout-url="/j_spring_security_logout" /> -->
		<!-- <security:access-denied-handler error-page="/denied"/> -->
		<security:session-management
			invalid-session-url="/" session-fixation-protection="migrateSession">
			<security:concurrency-control
				max-sessions="1" expired-url="/login" />
		</security:session-management>
	</security:http>
	<security:authentication-manager id="dao-auth">
		<!-- <security:authentication-provider user-service-ref="userDetailsService"> -->
		<!-- </security:authentication-provider> -->
	</security:authentication-manager>
	<bean id="apiEncryption" class="com.sdl.umang.main.EncryptionDecryption"></bean>
	<bean id="objShaPasswordEncoder" class="org.springframework.security.authentication.encoding.ShaPasswordEncoder">
     	<constructor-arg value="256"/>
 	</bean>
	<bean id="encryptionUtility" class="in.spicedigital.umang.utility.Utility">
		<constructor-arg  ref="apiEncryption"></constructor-arg>
	</bean>
	
	<bean id="AuthenticationFilter" class="in.spicedigital.umang.filter.RestAuthenticationFilter">
		<property  name="encryptionUtility" ref="encryptionUtility"></property>
	</bean>
	

</beans>
